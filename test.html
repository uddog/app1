<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV Background Color</title>
</head>
<body>

<script>
    // Function to fetch CSV data from a URL
    function fetchCSV(url, callback) {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4 && xhr.status === 200) {
                callback(xhr.responseText);
            }
        };
        xhr.open("GET", url, true);
        xhr.send();
    }

    // Function to parse CSV data and get background color from B1 cell
    function getBackgroundColor(csvData) {
        // Split CSV rows
        var rows = csvData.split('\n');
        if (rows.length > 0) {
            // Split columns of the first row
            var columns = rows[0].split(',');
            if (columns.length > 1) {
                // Get background color from B1 cell (assuming B1 is the second column)
                var backgroundColor = columns[1].trim();
                // Apply background color to the body element
                document.body.style.backgroundColor = backgroundColor;
            }
        }
    }

    // CSV URL
    var csvURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT5yPBQL7OkwisJJ6Dq4jpzATrchx3wbyxQQ09mH0BoPrTFr8FYnKxkT7xjvWB8P51Gled65w6S8VQH/pub?output=csv&gid=366259374';

    // Fetch CSV data and get background color
    fetchCSV(csvURL, getBackgroundColor);
</script>

</body>
</html>
